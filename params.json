{"name":"Lef","body":"Written with [LÖVE][love] in mind, but will\r\nprobably for any implementation of [lua][] 5.1 or above.\r\n\r\nIf you want a decent overview of entity frameworks and why they are\r\nuseful, have a read of these blog post by [Richard Lord][rl]:\r\n\r\n- [What is an entity framework for game development?][rl_1]\r\n- [Why use an entity framework for game development?][rl_2]\r\n\r\nlef isn't as advanced as the frameworks mentioned in those articles,\r\nbut it's good enough to play around with in lua. I'll probably use it\r\nin the next [Ludum Dare][ld] I play along with, so no doubt there will be\r\nlots of changes made to this after that.\r\n\r\nHere's a very simple example if you are using [LÖVE][love]. It creates\r\nan image which follows the mouse cursor around.\r\n\r\n```lua\r\n-- Load the module\r\nlocal lef = require 'nah.lef'\r\n\r\n----------------------------------------\r\n-- Register some components\r\nlef.registerComponentFactory('position', function() return {x = 0, y = 0} end )\r\nlef.registerComponentFactory('renderable', function() return {image = nil} end )\r\n\r\n----------------------------------------\r\n-- Create some systems\r\nlef.addSystem('render', 'draw images', function(entities)\r\n    for i, entity in ipairs(entities) do\r\n        local pos, img = lef.entityComponents(entity, 'position', 'renderable')\r\n        love.graphics.draw(img.image, pos.x, pos.y)\r\n    end\r\nend, 'position', 'renderable')\r\n\r\nlef.addSystem('logic', 'follow mouse', function(entities)\r\n    for i, entity in ipairs(entities) do\r\n        local pos = lef.entityComponents(entity, 'position')\r\n        pos.x = love.mouse.getX()\r\n        pos.y = love.mouse.getY()\r\n    end\r\nend, 'position', 'active cursor')\r\n\r\n----------------------------------------\r\n-- Update the systems\r\nfunction love.update()\r\n    lef.updateSystem('logic')\r\nend\r\n\r\nfunction love.draw()\r\n    lef.updateSystem('render')\r\nend\r\n\r\n----------------------------------------\r\n-- Add some entites when it loads\r\nfunction love.load()\r\n    -- Create the entity that follows the cursor\r\n    local cursimg = lef.addEntityComponents('cursor', 'renderable', 'active cursor', 'position')\r\n    cursimg.image = love.graphics.newImage('sheep.png')\r\n\r\n    -- Place some other random entites which will be rendered but\r\n    -- will not follow the cursor\r\n    local img, pos\r\n    for i=1, 100 do\r\n        -- Using a new empty table for each entity because we don't really\r\n        -- care what it is in this example.\r\n        img, pos = lef.addEntityComponents({}, 'renderable', 'position')\r\n        img.image = cursimg.image\r\n        pos.x = 800 * math.random()\r\n        pos.y = 600 * math.random()\r\n    end\r\nend\r\n```\r\n\r\n[rl]:   http://www.richardlord.net/blog\r\n[rl_1]: http://www.richardlord.net/blog/what-is-an-entity-framework\r\n[rl_2]: http://www.richardlord.net/blog/why-use-an-entity-framework\r\n[ld]:   http://www.ludumdare.com/compo/\r\n[love]: http://love2d.org/\r\n[lua]:  http://lua.org/\r\n","tagline":"Simple entity framework for lua.","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}